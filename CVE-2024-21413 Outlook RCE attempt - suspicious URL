 alert tcp $EXTERNAL_NET any -> $INTERNAL_NET 25 (msg:"CVE-2024-21413 Outlook RCE attempt - suspicious URL";flow:established; content:"file://"; http_method; uri;             
  sid:1000001; reference:url,https://github.com/xaitax/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability/; classtype:attempted-exploit; priority:3;)


Explanation:

alert tcp $EXTERNAL_NET any -> $INTERNAL_NET 25: Defines the rule to inspect incoming TCP traffic on port 25 (SMTP) originating from the external network and destined for the internal network.

msg:"CVE-2024-21413 Outlook RCE attempt - suspicious URL": Provides a descriptive message for the alert.

flow:established: Ensures the rule only triggers on established connections.

content:"file://": Looks for the presence of the suspicious pattern "file://" within the traffic content.

http_method: Specifies that the rule should only consider traffic with an HTTP method (might need adjustment depending on the exploit details).

uri: Examines the Uniform Resource Identifier (URI) within the traffic for potentially malicious content.
